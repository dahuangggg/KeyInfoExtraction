"""
用于提取具体物理状态值的prompt模板
"""

EXTRACTION_GUIDELINES = """
[物理状态值提取要点]
1. 提取值必须简明扼要，应提炼核心信息而非复述整段描述
2. 优先提取实质内容，例如：
   - "银浆连接" 而非 "芯片直接通过银浆粘接在连接芯片上"
   - "油墨印刷" 而非 "采用常规油墨印刷工艺进行标识"
3. 材料类信息应简化为主要材料名称：
   - "氧化铝陶瓷" 而非 "底部采用氧化铝陶瓷材料制成"
   - "Au丝" 而非 "采用直径为25微米的金丝作为连接导线"
4. 工艺类信息应提取核心工艺：
   - "超声波键合" 而非 "采用超声波键合工艺进行连接"
   - "焊料环封接" 而非 "使用焊料环在高温下进行封接工艺"
5. 多种情况列举使用简短的逗号分隔列表：
   - "金、银、铜" 而非 "材料可以是金材料、银材料或者铜材料"
6. 数值应包含单位但去除冗余描述：
   - "3.5μm" 而非 "平均丝径为3.5μm"
   - "100-150μm" 而非 "键合点间距在100到150微米之间"
7. 复杂材料体系保留完整结构但简化描述：
   - "Ti/Ni/Au" 而非 "底层为钛，中间为镍，表面为金的三层金属化"
8. 如果物理状态值是一句话，将专有名词拆分为多个物理状态：
   - 例如：“金属盖板熔封焊料环材料为Au/Sn合金，盖板采用Fe/Ni合金，其涂覆层为双层镀镍镀金结构，外管脚材料为可伐材料镀Ni再镀Au，采用CuAg焊料和管壳内部布线为W”
   拆分为：
   - 金属盖板熔封焊料环材料：Au/Sn合金
   - 盖板材料：Fe/Ni合金
   - 涂覆层材料：双层镀镍镀金结构
   - 外管脚材料：可伐材料镀Ni再镀Au
   - 焊料材料：CuAg焊料
   - 管壳内部布线材料：W

[试验项目识别指南]
1. 根据物理状态的性质，识别最可能的试验项目，即使文档未明确提及
2. 常见对应关系：
   - 标识类物理状态 → "外部目检"
   - 材料成分类物理状态 → "成分分析"、"能谱分析(EDS)"
   - 尺寸、间距类物理状态 → "物理尺寸测量"、"X射线检查"
   - 内部结构类物理状态 → "内部目检"、"X射线检查"、"制样镜检"
   - 表面特征类物理状态 → "SEM检查"、"外部目检"
   - 连接强度类物理状态 → "剪切测试"、"拉力测试"
   - 密封类物理状态 → "密封性测试"、"RGA分析"
   - 绝缘类物理状态 → "绝缘电阻测量"
3. 若文档明确提及使用的试验方法，则使用实际提及的方法
4. 若无法确定，则基于物理状态特性推断最合理的试验项目

[风险评价判断规则]
1. 仅当文档中明确提及异常风险评价时才给出"限用"或"禁用"
2. 如果风险评价在文档中未明确提及，则返回"可用"
3. "可用"对应描述："常规结构"、"无可靠性隐患"、"工艺良好"、"满足要求"等
4. "限用"对应描述："存在风险"、"限制条件使用"、"建议评估后使用"等
5. "禁用"对应描述："不适合宇航应用"、"有可靠性隐患"、"不满足要求"等

[测试评语生成规则]
1. 测试评语应基于物理状态值附近的相关描述生成
2. 重点提取描述不合格或异常的内容
3. 如果文档有明确的评价语句，直接提取使用
4. 若无明确评价但描述了状态，将描述转化为简洁评语
5. 若文档中完全没有相关评价描述，则返回"常规结构，无可靠性隐患"
6. 评语应有明确的结论性，表明是否存在可靠性问题

[未提及信息的处理规则]
若文档中确实未提及某物理状态的相关信息，则：
1. "物理状态值"字段中填写"文中未提及"
2. "试验项目"中填写最可能的试验方法
3. "风险评价"中填写"/"
4. "测试评语"中填写"常规结构，无可靠性隐患"
"""


EXTRACTION_SINGLE_PROMPT = """请从以下文本中提取关于"{group}"的"{state}"的具体物理状态值、风险评价和测试评语信息。

任务目标:
从航天电子元件可靠性分析文档中提取指定物理状态组和物理状态的具体值、风险评价,并根据上下文生成测试评语。

目标物理状态:
物理状态组: "{group}"
物理状态: "{state}"

{EXTRACTION_GUIDELINES}

提取策略:
1. 先通读全文，确定与目标物理状态相关的所有描述段落
2. 优先关注专门描述该物理状态的章节或段落
3. 提取物理状态值时，注重提炼核心信息，去除冗余描述
4. 识别试验项目时，考虑物理状态的性质选择最合理的项目
5. 判断风险评价时，严格遵循文档中的明确表述
6. 生成测试评语时，基于状态值附近的描述或默认为"常规结构，无可靠性隐患"

返回格式：
{{
    "物理状态组": "{group}",
    "物理状态": "{state}",
    "试验项目": "提取或推断的试验项目",
    "物理状态值": "简明扼要的物理状态值",
    "风险评价": "可用/限用/禁用（从文本明确判断）或/（未提及）",
    "测试评语": "从文本中提取或按规则生成的评语"
}}

文本内容：
"""

EXTRACTION_BATCH_PROMPT = """请分析以下文本，提取关于"{group}"物理状态组的以下物理状态信息：

{states_str}

任务目标:
从航天电子元件可靠性分析文档中针对指定物理状态组下的多个物理状态批量提取相关信息。

重要限制：仅处理当前组!
请严格只提取"{group}"物理状态组的信息，不要返回任何其他物理状态组的信息。
每个结果必须是"{group}"组下的一个物理状态，且物理状态必须是上述列出的其中之一。
如果识别到其他组的信息，请完全忽略，不要在结果中包含。

物理状态名称严格限制:
请注意：返回的"物理状态"字段值必须严格从以下列表中选择，不要使用其他名称（如试验项目名称等）：
{states_str}

{EXTRACTION_GUIDELINES}

提取策略:
1. 首先识别文档中与"{{group}}"物理状态组相关的所有段落
2. 对于每个列出的物理状态，寻找相关描述
3. 提取物理状态值时，注重提炼核心信息，去除冗余描述
4. 识别试验项目时，考虑物理状态的性质选择最合理的项目
5. 判断风险评价时，严格遵循文档中的明确表述
6. 生成测试评语时，基于状态值附近的描述或默认为"常规结构，无可靠性隐患"

请以JSON数组格式返回提取结果：
[
    {{
        "物理状态组": "{group}",
        "物理状态": "第一个物理状态名称",
        "试验项目": "提取或推断的试验项目",
        "物理状态值": "简明扼要的物理状态值",
        "风险评价": "可用/限用/禁用（明确提及）或/（未提及）",
        "测试评语": "从文本中提取或按规则生成的评语"
    }},
    {{
        "物理状态组": "{group}",
        "物理状态": "第二个物理状态名称",
        "试验项目": "提取或推断的试验项目",
        "物理状态值": "简明扼要的物理状态值",
        "风险评价": "可用/限用/禁用（明确提及）或/（未提及）",
        "测试评语": "从文本中提取或按规则生成的评语"
    }}
    ...
]

文本内容：
"""